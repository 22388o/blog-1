<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vulnerability Disclosure affecting BTCPay Server &lt;=  v1.0.7.0 | BTCPay Server Blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" href="/styles/btcpayserver-variables.css">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="description" content="Official BTCPay Server Blog">
    <meta property="article:published_time" content="2021-04-29T00:00:00.000Z">
    <meta property="og:site_name" content="BTCPay Server Blog">
    <meta property="og:title" content="Vulnerability Disclosure affecting BTCPay Server <=  v1.0.7.0">
    <meta property="og:description" content="On March 30th, we released BTCPay Server v1.0.7.1. This version was a security release that patched one critical, one medium and several low-impact vulnerabilities in all BTCPay Server versions prior to v.1.0.7.1https://github.com/btcpayserver/btcpayserver/blob/master/Changelog.md#1071.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://blog.btcpayserver.org/_posts/vulnerability-disclosure-v1-0-7-0/">
    <meta property="og:image" content="https://blog.btcpayserver.org/card.png">
    <meta name="twitter:title" content="Vulnerability Disclosure affecting BTCPay Server <=  v1.0.7.0">
    <meta name="twitter:description" content="On March 30th, we released BTCPay Server v1.0.7.1. This version was a security release that patched one critical, one medium and several low-impact vulnerabilities in all BTCPay Server versions prior to v.1.0.7.1https://github.com/btcpayserver/btcpayserver/blob/master/Changelog.md#1071.">
    <meta name="twitter:url" content="https://blog.btcpayserver.org/_posts/vulnerability-disclosure-v1-0-7-0/">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:image" content="https://blog.btcpayserver.org/card.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="BTCPay Server Blog">
    <meta name="twitter:creator" content="btcpayserver">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="BTCPay Server">
    <meta property="article:tag" content="BTCPay Server">
    
    <link rel="preload" href="/assets/css/0.styles.acb81e89.css" as="style"><link rel="preload" href="/assets/js/app.4ab92167.js" as="script"><link rel="preload" href="/assets/js/12.074be7ff.js" as="script"><link rel="preload" href="/assets/js/8.3ecaf3c3.js" as="script"><link rel="preload" href="/assets/js/3.404701ce.js" as="script"><link rel="preload" href="/assets/js/11.36bdd207.js" as="script"><link rel="preload" href="/assets/js/56.42af95cc.js" as="script"><link rel="preload" href="/assets/js/10.180cd965.js" as="script"><link rel="prefetch" href="/assets/js/13.53dda790.js"><link rel="prefetch" href="/assets/js/14.85495063.js"><link rel="prefetch" href="/assets/js/15.3be86f39.js"><link rel="prefetch" href="/assets/js/16.2e69b545.js"><link rel="prefetch" href="/assets/js/17.faa73ca6.js"><link rel="prefetch" href="/assets/js/18.e87f0309.js"><link rel="prefetch" href="/assets/js/19.c802f22d.js"><link rel="prefetch" href="/assets/js/20.b3eff72d.js"><link rel="prefetch" href="/assets/js/21.85dfaa33.js"><link rel="prefetch" href="/assets/js/22.606395b7.js"><link rel="prefetch" href="/assets/js/23.5d84c99a.js"><link rel="prefetch" href="/assets/js/24.4f6b503a.js"><link rel="prefetch" href="/assets/js/25.8e6e7a09.js"><link rel="prefetch" href="/assets/js/26.a03ca488.js"><link rel="prefetch" href="/assets/js/27.8c67ce51.js"><link rel="prefetch" href="/assets/js/28.bde09a65.js"><link rel="prefetch" href="/assets/js/29.944ae902.js"><link rel="prefetch" href="/assets/js/30.c3094e4d.js"><link rel="prefetch" href="/assets/js/31.d6931c8c.js"><link rel="prefetch" href="/assets/js/32.549cf2d1.js"><link rel="prefetch" href="/assets/js/33.7053e1ce.js"><link rel="prefetch" href="/assets/js/34.364676dd.js"><link rel="prefetch" href="/assets/js/35.3e43f5d1.js"><link rel="prefetch" href="/assets/js/36.06dbcc29.js"><link rel="prefetch" href="/assets/js/37.309d8e8a.js"><link rel="prefetch" href="/assets/js/38.24022da5.js"><link rel="prefetch" href="/assets/js/39.5635f5bd.js"><link rel="prefetch" href="/assets/js/4.f691a4c9.js"><link rel="prefetch" href="/assets/js/40.92b05792.js"><link rel="prefetch" href="/assets/js/41.f9fc68b2.js"><link rel="prefetch" href="/assets/js/42.a3935dd9.js"><link rel="prefetch" href="/assets/js/43.9f9276c5.js"><link rel="prefetch" href="/assets/js/44.6e0918ae.js"><link rel="prefetch" href="/assets/js/45.00fd5a9e.js"><link rel="prefetch" href="/assets/js/46.27317653.js"><link rel="prefetch" href="/assets/js/47.7866fcf8.js"><link rel="prefetch" href="/assets/js/48.9b892ccc.js"><link rel="prefetch" href="/assets/js/49.8fc2e773.js"><link rel="prefetch" href="/assets/js/5.180c21ce.js"><link rel="prefetch" href="/assets/js/50.055e2d39.js"><link rel="prefetch" href="/assets/js/51.ac7d2ba9.js"><link rel="prefetch" href="/assets/js/52.7358cdbd.js"><link rel="prefetch" href="/assets/js/53.7b2402be.js"><link rel="prefetch" href="/assets/js/54.29ddd3ec.js"><link rel="prefetch" href="/assets/js/55.b9148e2d.js"><link rel="prefetch" href="/assets/js/57.177ab96e.js"><link rel="prefetch" href="/assets/js/58.fed26ef0.js"><link rel="prefetch" href="/assets/js/6.af583b3b.js"><link rel="prefetch" href="/assets/js/7.2d9964c9.js"><link rel="prefetch" href="/assets/js/9.6a24b457.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.6a021120.js">
    <link rel="stylesheet" href="/assets/css/0.styles.acb81e89.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div data-v-1c5a4c46><div class="theme-default-content post-meta" data-v-7b6ac25c data-v-1c5a4c46><h1 class="index-post-title" data-v-7b6ac25c>
    Vulnerability Disclosure affecting BTCPay Server &lt;=  v1.0.7.0
  </h1> <p class="meta" data-v-7b6ac25c>
    Posted in

    <span data-v-7b6ac25c><a href="/category/announcements" class="meta-link" data-v-7b6ac25c>Announcements</a><!----></span>

    by

    <a href="/author/pavlenex" class="meta-link" data-v-7b6ac25c>
      pavlenex</a>

    on

    4/30/2021
  </p> <img src="/images/BTCPay_Vuln_Disc_1.0.7.0.png" class="cover-image" data-v-7b6ac25c></div> <div class="theme-container no-sidebar" data-v-1c5a4c46><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/btcpay-logo.svg" alt="BTCPay Server Blog" class="logo"> <span class="site-name can-hide">BTCPay Server Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/category/releases/" class="nav-link">
  Releases
</a></div><div class="nav-item"><a href="/category/stories/" class="nav-link">
  Stories
</a></div><div class="nav-item"><a href="/category/guides/" class="nav-link">
  Guides
</a></div><div class="nav-item"><a href="/category/announcements/" class="nav-link">
  Announcements
</a></div><div class="nav-item"><a href="/category/features/" class="nav-link">
  Features
</a></div><div class="nav-item"><a href="/category/plugins/" class="nav-link">
  Plugins
</a></div><div class="nav-item"><a href="https://btcpayserver.org/" target="_blank" rel="noopener noreferrer website" class="nav-link external">
  Website
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://chat.btcpayserver.org/" target="_blank" rel="noopener noreferrer chat" class="nav-link external">
  Chat
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/btcpayserver/" target="_blank" rel="noopener noreferrer github" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://twitter.com/BtcpayServer" target="_blank" rel="noopener noreferrer twitter" class="nav-link external">
  Twitter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/btcpayserver/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <button type="button" class="btcpay-theme-switch"><svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path transform="translate(1 1)" d="M2.72 0A3.988 3.988 0 000 3.78c0 2.21 1.79 4 4 4 1.76 0 3.25-1.14 3.78-2.72-.4.13-.83.22-1.28.22-2.21 0-4-1.79-4-4 0-.45.08-.88.22-1.28z" class="btcpay-theme-switch-dark"></path><path transform="translate(1 1)" d="M4 0c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5S4.28 0 4 0zM1.5 1c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm5 0c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zM4 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zM.5 3.5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm7 0c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zM1.5 6c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm5 0c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zM4 7c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5S4.28 7 4 7z" class="btcpay-theme-switch-light"></path></svg></button></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/category/releases/" class="nav-link">
  Releases
</a></div><div class="nav-item"><a href="/category/stories/" class="nav-link">
  Stories
</a></div><div class="nav-item"><a href="/category/guides/" class="nav-link">
  Guides
</a></div><div class="nav-item"><a href="/category/announcements/" class="nav-link">
  Announcements
</a></div><div class="nav-item"><a href="/category/features/" class="nav-link">
  Features
</a></div><div class="nav-item"><a href="/category/plugins/" class="nav-link">
  Plugins
</a></div><div class="nav-item"><a href="https://btcpayserver.org/" target="_blank" rel="noopener noreferrer website" class="nav-link external">
  Website
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://chat.btcpayserver.org/" target="_blank" rel="noopener noreferrer chat" class="nav-link external">
  Chat
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/btcpayserver/" target="_blank" rel="noopener noreferrer github" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://twitter.com/BtcpayServer" target="_blank" rel="noopener noreferrer twitter" class="nav-link external">
  Twitter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/btcpayserver/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><p>On March 30th, we released BTCPay Server v1.0.7.1. This version was a security release that patched one critical, one medium and several low-impact vulnerabilities in all BTCPay Server versions prior to <a href="https://github.com/btcpayserver/btcpayserver/blob/master/Changelog.md#1071" target="_blank" rel="noopener noreferrer">v.1.0.7.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>If you're a BTCPay Server user running a version older than v.1.0.7.1, we strongly recommend that you <strong>update your instance</strong>. To update, go to <em>Server Settings</em> &gt; <em>Maintenance</em> tab and click <em>Update</em> or use the command <em>btcpay-update.sh</em> in the command line.</p> <h2 id="⏱️-timeline"><a href="#⏱️-timeline" class="header-anchor">#</a> ⏱️ Timeline</h2> <ol><li><em>19.03.</em> - Vulnerabilities responsibly disclosed by Tesla's security engineering team.</li> <li><em>19.03.</em> - BTCPay Server team acknowledged the findings and started investigating.</li> <li><em>19.03.</em> - BTCPay Server team confirmed vulnerabilities.</li> <li><em>20.03-23.03</em> -BTCPay Server and Tesla security engineering team work together to patch the vulnerabilities and determine further steps.</li> <li><em>24.03</em> - Tesla security requests filing of the 6 CVE-IDs for disclosed issues.</li> <li><em>25.03</em> - Tesla Security team assist in filing the CVE-IDs with MITRE.</li> <li><em>26.03</em> - 6 CVE-IDs reserved with MITRE.</li> <li><em>30.03</em> - BTCPay Server v1.0.7.1 released that patches all vulnerabilities</li> <li><em>30.03</em> - BTCPay Server publicly acknowledged the findings and announced a new release urging affected users to update in order to mitigate.</li></ol> <p>In this article, we are disclosing the vulnerabilities.</p> <h2 id="cve-2021-29251-account-takeover"><a href="#cve-2021-29251-account-takeover" class="header-anchor">#</a> CVE-2021-29251 (Account takeover)</h2> <p>A malicious party could generate an email asking for a password reset to the victim. If the victim clicked on the link in the mail (or if some anti-virus email software automatically visited such link), then the targeted account could be taken over.</p> <ul><li><strong>Details</strong>: Host header manipulation (Host, X-Forwarded- Host, and X-Forwarded-For) which allows an attacker to spoof password reset URL which leads to an account takeover with either no user interaction under certain circumstances where enterprise mail clients are used or with single-click user interaction.</li> <li><strong>Users affected</strong>: Users running docker deployment, that have email server settings set up and share their instance with other users.</li> <li><strong>Impact</strong>: Account takeover / Escalation of Privileges</li> <li><strong>Severity</strong>: Critical</li> <li><strong>Affected versions</strong> &lt;= 1.0.7.1</li></ul> <h2 id="cve-2021-29246-path-traversal"><a href="#cve-2021-29246-path-traversal" class="header-anchor">#</a> CVE-2021-29246 (Path Traversal)</h2> <p>BTCPay Server was not properly validating file name in upload forms, which could result in uploaded files to be saved in arbitrary location on the server. The forms needed admin permission.</p> <ul><li><strong>Details</strong>: BTCPay versions &lt;= 1.0.7.0 suffers from directory traversal which allows an attacker with admin privileges to craft a malicious plugin file with special characters to upload the file outside of the restricted directory which leads to code execution.</li> <li><strong>Impact</strong>: Code Execution</li> <li><strong>Severity</strong>: Medium</li> <li><strong>Affected versions</strong> &lt;= 1.0.7.1</li></ul> <h2 id="cve-2021-29250-stored-xss"><a href="#cve-2021-29250-stored-xss" class="header-anchor">#</a> CVE-2021-29250 (Stored XSS)</h2> <p>XSS vulnerability in the Point of Sale feature.</p> <ul><li><strong>Details</strong>: BTCPay versions &lt;= 1.0.7.0 suffer from Stored Cross-Site Scripting (XSS) vulnerability within POS Add Products functionality which enables cookie stealing.</li> <li><strong>Impact</strong>: Cross Site Scripting (XSS)</li> <li><strong>Severity</strong>: Medium</li> <li><strong>Affected versions</strong> &lt;= 1.0.7.1</li></ul> <h2 id="cve-2021-29245-insufficient-randomness"><a href="#cve-2021-29245-insufficient-randomness" class="header-anchor">#</a> CVE-2021-29245 (Insufficient Randomness)</h2> <p>The generation of legacy API Keys and the selection of UTXOs in Payjoin were using a weak RNG.<br>
Legacy API Key can only be used to generate new invoices. If you use those, we advise you to regenerate a new API Key for your store.</p> <ul><li><strong>Details</strong>: Method GenerateLegacyAPIKey at TokenRepository.cs uses a weak method Next to produce random values.</li> <li><strong>Impact</strong>: Other/API</li> <li><strong>Severity</strong>: Low</li> <li><strong>Affected versions</strong> &lt;= 1.0.7.1</li></ul> <h2 id="cve-2021-29247-lack-of-httponly"><a href="#cve-2021-29247-lack-of-httponly" class="header-anchor">#</a> CVE-2021-29247 (Lack of httponly)</h2> <p>A cookie we are using for saving preferences of users (such as the search string in the invoices page) could be used from javascript because it was missing the httponly flag.</p> <ul><li><strong>Details</strong>: BTCPay versions &lt;= 1.0.7.0 could allow a remote attacker to obtain sensitive information caused by the failure to set the HTTPOnly flag. A remote attacker could exploit this vulnerability to obtain sensitive information from the cookie.</li> <li><strong>Severity</strong>: Low</li> <li><strong>Affected versions</strong> &lt;= 1.0.7.1</li></ul> <h2 id="cve-2021-29248-lack-of-secure"><a href="#cve-2021-29248-lack-of-secure" class="header-anchor">#</a> CVE-2021-29248 (Lack of secure)</h2> <ul><li><strong>Details</strong>: BTCPay versions &lt;= 1.0.7.0 could allow a remote attacker to obtain sensitive information, caused by the failure to set the Secure flag. A remote attacker could exploit this vulnerability to obtain sensitive information from the cookie.</li> <li><strong>Severity</strong>: Low</li> <li><strong>Affected</strong> <strong>versions</strong> &lt;= 1.0.7.1</li></ul> <h2 id="cve-2021-29250-stored-xss-2"><a href="#cve-2021-29250-stored-xss-2" class="header-anchor">#</a> CVE-2021-29250 (Stored XSS)</h2> <p>XSS vulnerability in the Point of Sale feature.</p> <ul><li><strong>Details</strong>: BTCPay versions &lt;= 1.0.7.0 suffer from Stored Cross-Site Scripting (XSS) vulnerability within POS Add Products functionality which enables cookie stealing.</li> <li><strong>Impact</strong>: Cross Site Scripting (XSS)</li> <li><strong>Severity</strong>: Medium</li> <li><strong>Affected version</strong>s &lt;= 1.0.7.1</li></ul> <h2 id="no-rate-limit-of-forget-password-page"><a href="#no-rate-limit-of-forget-password-page" class="header-anchor">#</a> No rate limit of forget password page</h2> <p>This vulnerability was reported by Qaiser Abbas, an independent researcher.</p> <ul><li><strong>Details</strong>: The forget password page was not properly rate-limiting the attempts, resulting in a malicious user mail bombard the victim with forget password emails.</li> <li><strong>Severity</strong>: Low</li> <li><strong>Affected versions</strong> &lt;= 1.0.7.1</li></ul> <h2 id="summary"><a href="#summary" class="header-anchor">#</a> Summary</h2> <p>We would like to thank Tesla for submitting the disclosure that led to these fixes and helping us with remediation. We also want to thank Qaiser Abbas, an independent web-security researcher, for an additional responsible vulnerability disclosure that was handled in this release.</p> <p>As an open-source project the privacy and security of our users and community are our priority and we're investing efforts in further improving our security processes, including the creation of a bug-bounty program.</p> <p>Thank you! 💚</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/9/2021, 7:59:52 PM</span></div></footer> <!----> </main></div> <div class="theme-default-content sponsors" data-v-0a42ac82 data-v-1c5a4c46><hr data-v-0a42ac82> <p data-v-0a42ac82>
    We are proudly supported by these entities through the
    <a href="https://foundation.btcpayserver.org/" target="_blank" data-v-0a42ac82>BTCPay Server Foundation</a>:
  </p> <div class="sponsors-logos" data-v-0a42ac82><a href="https://www.kraken.com" target="_blank" class="sponsor-item" data-v-0a42ac82><img src="/images/krakenlogo-150x150.png" class="logo" data-v-0a42ac82>
      Kraken
    </a> <a href="https://twitter.com/sqcrypto" target="_blank" class="sponsor-item" data-v-0a42ac82><img src="/images/squarecrypto-150x150.png" class="logo" data-v-0a42ac82>
      Square Crypto
    </a> <a href="https://acinq.co/" target="_blank" class="sponsor-item" data-v-0a42ac82><img src="/images/acinq-logo-289x300.png" class="logo" data-v-0a42ac82>
      ACINQ
    </a> <a href="https://www.lunanode.com/" target="_blank" class="sponsor-item" data-v-0a42ac82><img src="/images/lunanode-150x150.png" class="logo" data-v-0a42ac82>
      LunaNode
    </a> <a href="https://walletofsatoshi.com/" target="_blank" class="sponsor-item" data-v-0a42ac82><img src="/images/walletofsatoshi-150x150.png" class="logo" data-v-0a42ac82>
      Wallet of Satoshi
    </a> <a href="https://nomics.com/" target="_blank" class="sponsor-item" data-v-0a42ac82><img src="/images/nomicspng-150x150.png" class="logo" data-v-0a42ac82>
      Nomics
    </a> <a href="https://coincards.com/" target="_blank" class="sponsor-item" data-v-0a42ac82><img src="/images/coincards-150x150.png" class="logo" data-v-0a42ac82>
      Coincards
    </a></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4ab92167.js" defer></script><script src="/assets/js/12.074be7ff.js" defer></script><script src="/assets/js/8.3ecaf3c3.js" defer></script><script src="/assets/js/3.404701ce.js" defer></script><script src="/assets/js/11.36bdd207.js" defer></script><script src="/assets/js/56.42af95cc.js" defer></script><script src="/assets/js/10.180cd965.js" defer></script>
  </body>
</html>
